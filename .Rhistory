2+3
business<-readRDS("C:/Users/michael.hunt/Rspace/JHU_CAP_data/businessData.rds")
user<-readRDS("C:/Users/michael.hunt/Rspace/JHU_CAP_data/userData.rds")
setwd("C:/Users/michael.hunt/Rspace/JHU_CAP")
# business<- readRDS("E:/Rspace/JHU_CAP_data/businessData.rds")
library(maps)
library(ggplot2)
library(ggmap)
map("world", ylim=c(10,70), xlim=c(-130,25), col="gray60")
points(business$longitude, business$latitude,pch=19, col="red")
cities=c("Edinburgh","Karlsruhe","Pittsburgh","Charlotte","Urbana","Waterloo","Montreal","Madison","Las Vegas","Phoenix")
latlon<-geocode(cities,source="google",messaging=FALSE)
points(latlon$lon, latlon$lat,pch=19, col="cyan4")
ma<-kmeans(cbind(business$longitude,business$latitude),latlon)
business$cluster=ma$cluster
uc<-cbind(cities,ma$centers,ma$size)
