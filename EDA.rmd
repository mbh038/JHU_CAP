---
title: "Untitled"
output: html_document
---

```{r get the data}
## Get the data

library(jsonlite)
if(!file.exists("data")){dir.create("data")}

# business data
businessData<- stream_in(file("E:/RSpace/yelp_dataset/business.json"))
saveRDS(businessData,"./data/businessData.rds")
rm(businessData)

# checkin datastr(review)
checkinData<- stream_in(file("E:/RSpace/yelp_dataset/yelp_academic_dataset_checkin.json"))
saveRDS(checkinData,"./data/checkinData.rds")
rm(checkinData)

# review data
reviewData<- stream_in(file("E:/RSpace/yelp_dataset/yelp_academic_dataset_review.json"))
saveRDS(reviewData,"./data/reviewData.rds")
rm(reviewData)

# tip data
tipData<- stream_in(file("E:/RSpace/yelp_dataset/yelp_academic_dataset_tip.json"))
saveRDS(tipData,"./data/tipData.rds")
rm(tipData)

# user data
userData<- stream_in(file("E:/RSpace/yelp_dataset/yelp_academic_dataset_user.json"))
saveRDS(userData,"./data/userData.rds")
rm(userData)
```
```{r load review data}
# review<- readRDS("C:/Users/michael.hunt/Rspace/JHU_CAP_data/reviewData.rds")
review<- readRDS("E:/Rspace/JHU_CAP_data/reviewData.rds")
```

```{r load business data}
#business<-readRDS("C:/Users/michael.hunt/Rspace/JHU_CAP_data/businessData.rds")
business<- readRDS("E:/Rspace/JHU_CAP_data/businessData.rds")
```

```{r load user data}
#user<-readRDS("C:/Users/michael.hunt/Rspace/JHU_CAP_data/userData.rds")
user<- readRDS("E:/Rspace/JHU_CAP_data/userData.rds")
```

```{r USA map,cache=TRUE}
library(raster)
library(sp)
# get USA state boundary data
adm <- readRDS("USA_adm1.rds")
# cornwall=adm[adm$NAME_2=="Cornwall",]
# rm(adm)
```
```{r USA map}
library(leaflet)
m<-leaflet() %>%
  addTiles() %>% # use default OpenStreetMap tile
  #addPolygons(data=adm, weight = 1,fillOpacity = 0.) %>%
  addMarkers (data=business,lng=business$longitude,lat=business$latitude) %>%
  setView(lng = -105, lat = 39, zoom = 3)# %>% # centre on USA
m
```
